%%*************************************************************************
% This function defines the load-generation pattern of rts24 for CPF-based
% probabilistic available transfer capability (ATC) assessement.
% Copyright(c) 2018 Hao Sheng & Xiaozhe Wang, McGill University
%%*************************************************************************
function pattern = pattern_case24

%% 1. Specify the bus load increase pattern.
% *************************************************************************

% Bus_Idx,Bus_I,Delta_Pd,Delta_Qd,Area,Qd/Pd
pattern.bus = [...
     1      1     0.000000     0.000000   1     0.203704;
     2      2     0.000000     0.000000   1     0.206186;
     3      3    40.000000     0.000000   1     0.205556;
     4      4    40.000000     0.000000   1     0.202703;
     5      5     0.000000     0.000000   1     0.197183;
     6      6     0.000000     0.000000   2     0.205882;
     7      7     0.000000     0.000000   2     0.200000;
     8      8     0.000000     0.000000   2     0.204678;
     9      9     0.000000     0.000000   1     0.205714;
    10     10     0.000000     0.000000   2     0.205128;
    11     11     0.000000     0.000000   3     0.000000;
    12     12     0.000000     0.000000   3     0.000000;
    13     13     0.000000     0.000000   3     0.203774;
    14     14     0.000000     0.000000   3     0.201031;
    15     15     0.000000     0.000000   4     0.201893;
    16     16     0.000000     0.000000   4     0.200000;
    17     17     0.000000     0.000000   4     0.000000;
    18     18     0.000000     0.000000   4     0.204204;
    19     19     0.000000     0.000000   3     0.204420;
    20     20     0.000000     0.000000   3     0.203125;
    21     21     0.000000     0.000000   4     0.000000;
    22     22     0.000000     0.000000   4     0.000000;
    23     23     0.000000     0.000000   3     0.000000;
    24     24     0.000000     0.000000   4     0.000000;
];

%% Update Qd according to Pd and Qd/Pd.
loadbus = find(abs(pattern.bus(:,3)) > 0.0);
if ~isempty(loadbus)
    pattern.bus(loadbus,4) = pattern.bus(loadbus,3) .* pattern.bus(loadbus,6);
end

%% 2. Specify the bus generation increase pattern.
% *************************************************************************

% Gen_Idx,Bus_I,Delta_Pg,Delta_Qg,Part_F,Area
pattern.gen = [...
     1      1     0.000000     0.000000   0.0000   1;
     2      1     0.000000     0.000000   0.0000   1;
     3      1     0.000000     0.000000   0.0000   1;
     4      1     0.000000     0.000000   0.0000   1;
     5      2     0.000000     0.000000   0.0000   1;
     6      2     0.000000     0.000000   0.0000   1;
     7      2     0.000000     0.000000   0.0000   1;
     8      2     0.000000     0.000000   0.0000   1;
     9      7     0.000000     0.000000   0.0000   2;
    10      7     0.000000     0.000000   0.0000   2;
    11      7     0.000000     0.000000   0.0000   2;
    12     13     0.000000     0.000000   0.0000   3;
    13     13     0.000000     0.000000   0.0000   3;
    14     13     0.000000     0.000000   0.0000   3;
    15     14     0.000000     0.000000   0.0000   3;
    16     15     0.000000     0.000000   0.0000   4;
    17     15     0.000000     0.000000   0.0000   4;
    18     15     0.000000     0.000000   0.0000   4;
    19     15     0.000000     0.000000   0.0000   4;
    20     15     0.000000     0.000000   0.0000   4;
    21     15     0.000000     0.000000   0.0000   4;
    22     16     0.000000     0.000000   0.0000   4;
    23     18     0.000000     0.000000   0.0000   4;
    24     21     0.000000     0.000000   0.0000   4;
    25     22     0.000000     0.000000   0.0000   4;
    26     22     0.000000     0.000000   0.0000   4;
    27     22     0.000000     0.000000   0.0000   4;
    28     22     0.000000     0.000000   0.0000   4;
    29     22     0.000000     0.000000   0.0000   4;
    30     22     0.000000     0.000000   0.0000   4;
    31     23    20.000000     0.000000   0.0000   3;
    32     23    20.000000     0.000000   0.0000   3;
    33     23    40.000000     0.000000   0.0000   3;
];

%% 3. Specify the contingency list defined in specified areas.
% *************************************************************************
% NOTE: CtgId is the unique identifier for a contingency in this system,
% and only contingencies with flag(1) will be generated and calculated.

% CtgId,Area,Type,Bus_I,Bus_J,Gen_Idx/Branch_Idx,flag
pattern.ctg = [...
     0     -1      0     -1     -1     -1   1;
     1      1      1      1     -1      1   1;
     2      1      1      2     -1      5   0;
     3      1      2      1      2      1   0;
     4      1      2      1      3      2   0;
     5      1      2      1      5      3   0;
     6      1      2      2      4      4   0;
     7      1      2      2      6      5   0;
     8      1      2      3      9      6   0;
     9      1      2      3     24      7   1;
    10      1      2      4      9      8   1;
    11      1      2      5     10      9   0;
    12      1      2      9     11     14   1;
    13      1      2      9     12     15   1;
    14      2      1      7     -1      9   0;
    15      2      2      6     10     10   0;
    16      2      2      7      8     11   0;
    17      2      2      8      9     12   0;
    18      2      2      8     10     13   0;
    19      2      2     10     11     16   0;
    20      2      2     10     12     17   0;
    21      3      1     13     -1     12   0;
    22      3      1     23     -1     31   0;
    23      3      2     11     13     18   0;
    24      3      2     11     14     19   0;
    25      3      2     12     13     20   0;
    26      3      2     12     23     21   0;
    27      3      2     13     23     22   0;
    28      3      2     14     16     23   0;
    29      3      2     19     20     34   0;
    30      3      2     19     20     35   0;
    31      3      2     20     23     36   0;
    32      3      2     20     23     37   0;
    33      4      1     15     -1     16   0;
    34      4      1     16     -1     22   0;
    35      4      1     18     -1     23   0;
    36      4      1     21     -1     24   0;
    37      4      1     22     -1     25   0;
    38      4      2     15     16     24   0;
    39      4      2     15     21     25   0;
    40      4      2     15     21     26   0;
    41      4      2     15     24     27   0;
    42      4      2     16     17     28   0;
    43      4      2     16     19     29   0;
    44      4      2     17     18     30   0;
    45      4      2     17     22     31   0;
    46      4      2     18     21     32   0;
    47      4      2     18     21     33   0;
    48      4      2     21     22     38   0;
];

%% 4. Specify the incremental voltage limits for [Vmin,Vmax] in contingency cases.
% *************************************************************************
pattern.vinc = [...
     0.04    -0.04;
];

%% 5. Define the interarea power or branch power.
% *************************************************************************
% Number,Area_Fr,Area_To,Type.
% Type: 1-area; 2-branch;
pattern.transfer = [...
    1       1       2    1;
    2       1       3    1;
    3       1       4    1;
    4       2       3    1;
    5       3       4    1;
    6      14      16    2;
    7      15      24    2;
];
